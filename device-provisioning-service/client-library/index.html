<!doctype html><html class=no-js lang=en-us><head><meta charset=utf-8><link rel=preload href=https://plgd.dev/fonts/muli-latin-200.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://plgd.dev/fonts/muli-latin-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://plgd.dev/fonts/muli-latin-800.woff2 as=font type=font/woff2 crossorigin><meta http-equiv=x-ua-compatible content="IE=edge"><title>Client Library | plgd</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=generator content="Hugo 0.83.1"><meta name=robots content="index, follow"><link rel=stylesheet href=/output/css/app.min.bab83909a2f2fe2aa45bf7e4813899f4f705e6858479cea5bd48eee72fdf0a70.css integrity="sha256-urg5CaLy/iqkW/fkgTiZ9PcF5oWEec6lvUju5y/fCnA=" crossorigin=anonymous><meta name=description content="How to create a client of plgd Device Provisioning Service?"><script type=text/javascript src=/output/js/app.175b405753a9c0ce86ab35944e9c4cc1a758a6873209cf5106600f6b2f5a59b6.js integrity="sha256-F1tAV1OpwM6GqzWUTpxMwadYpocyCc9RBmAPay9aWbY=" crossorigin=anonymous defer></script><script async defer src=https://buttons.github.io/buttons.js></script><script src=/js/medium-zoom.min.js></script><script src=/js/rawdeflate.js></script><script>window.addEventListener('load',a=>{mediumZoom(document.querySelectorAll('.medium-zoom-image'))})</script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png href=/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicon-16x16.png sizes=16x16><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#0594cb><meta name=theme-color content="#ffffff"><meta property="og:title" content="Client Library"><meta property="og:description" content="How to create a client of plgd Device Provisioning Service?"><meta property="og:type" content="article"><meta property="og:url" content="https://plgd.dev/device-provisioning-service/client-library/"><meta property="og:image" content="https://plgd.dev/images/plgd-logo-full-white.png"><meta property="article:section" content="device-provisioning-service"><meta property="article:published_time" content="2021-02-15T00:00:00+00:00"><meta property="article:modified_time" content="2022-02-16T16:23:19+01:00"><meta itemprop=name content="Client Library"><meta itemprop=description content="How to create a client of plgd Device Provisioning Service?"><meta itemprop=datePublished content="2021-02-15T00:00:00+00:00"><meta itemprop=dateModified content="2022-02-16T16:23:19+01:00"><meta itemprop=wordCount content="1312"><meta itemprop=image content="https://plgd.dev/images/plgd-logo-full-white.png"><meta itemprop=keywords content><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://plgd.dev/images/plgd-logo-full-white.png"><meta name=twitter:title content="Client Library"><meta name=twitter:description content="How to create a client of plgd Device Provisioning Service?"><script async src="https://www.googletagmanager.com/gtag/js?id=G-PS70WYYFKX"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-PS70WYYFKX',{anonymize_ip:!0,dimension1:'plgd.dev',dimension2:''});var trackOutboundLink=function(a,b){gtag('event','click',{event_category:'outbound',event_label:a,transport_type:'beacon'})}</script></head><body class="ma0 sans-serif bg-primary-color-light production"><nav class="bg-primary-color-dark pv4 w-100" role=navigation><div class="center flex-ns flex-wrap items-center justify-start mw9"><h1 class="dim f3 lh-solid ml0-ns mr0 mr4-l mv0 pl3 pl4-ns"><a href=https://plgd.dev/ class="link white plgd-font">plgd</a></h1><ul class="list ma0 pa0 dn dib-l"><li class="f5 dib mr4" role=menuitem><a href=/documentation/ class="dim link light-silver">Docs</a></li><li class="f5 dib mr4" role=menuitem><a href=/news/ class="dim link light-silver">News</a></li><li class="f5 dib mr4" role=menuitem><a href=https://gitter.im/ocfcloud/Lobby/ class="dim link light-silver">Community
<span class=pl1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="10" height="10" viewBox="0 0 32 32" class="fill-current v-base" aria-label="External Link"><path d="M25.152 16.576v5.696q0 2.144-1.504 3.648T20 27.424H5.152q-2.144.0-3.648-1.504t-1.504-3.648V7.424q0-2.112 1.504-3.616t3.648-1.536h12.576q.224.0.384.16t.16.416V4q0 .256-.16.416t-.384.16H5.152q-1.184.0-2.016.832t-.864 2.016v14.848q0 1.184.864 2.016t2.016.864H20q1.184.0 2.016-.864t.832-2.016v-5.696q0-.256.16-.416t.416-.16h1.152q.256.0.416.16t.16.416zM32 1.152v9.12q0 .48-.352.8t-.8.352-.8-.352l-3.136-3.136-11.648 11.648q-.16.192-.416.192t-.384-.192l-2.048-2.048q-.192-.16-.192-.384t.192-.416L24.064 5.088l-3.136-3.136q-.352-.352-.352-.8t.352-.8.8-.352h9.12q.48.0.8.352t.352.8z"/></svg></span></a></li><li class="f5 dib mr4" role=menuitem><a href=https://try.plgd.cloud class="dim link light-silver">Try LIVE
<span class=pl1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="10" height="10" viewBox="0 0 32 32" class="fill-current v-base" aria-label="External Link"><path d="M25.152 16.576v5.696q0 2.144-1.504 3.648T20 27.424H5.152q-2.144.0-3.648-1.504t-1.504-3.648V7.424q0-2.112 1.504-3.616t3.648-1.536h12.576q.224.0.384.16t.16.416V4q0 .256-.16.416t-.384.16H5.152q-1.184.0-2.016.832t-.864 2.016v14.848q0 1.184.864 2.016t2.016.864H20q1.184.0 2.016-.864t.832-2.016v-5.696q0-.256.16-.416t.416-.16h1.152q.256.0.416.16t.16.416zM32 1.152v9.12q0 .48-.352.8t-.8.352-.8-.352l-3.136-3.136-11.648 11.648q-.16.192-.416.192t-.384-.192l-2.048-2.048q-.192-.16-.192-.384t.192-.416L24.064 5.088l-3.136-3.136q-.352-.352-.352-.8t.352-.8.8-.352h9.12q.48.0.8.352t.352.8z"/></svg></span></a></li></ul><div class="db dib-ns pl3"><form id=site-search-form role=search><fieldset class="bn ma0 pa0"><label class=clip for=search-input>Search</label>
<input type=search id=search-input class="needs-js bg-left bn f5 input-reset lh-solid mt3 mt0-ns pl4 pv2 w5 white" placeholder="Search the Docs" name=search-input style="background:url(/images/icon-search.png)5px 11px/16px 16px no-repeat;background-color:rgba(255,255,255,0)"></fieldset></form></div></div></nav><main role=main class="content-with-sidebar min-vh-100 pb7 pb0-ns"><article class="w-100 ph4 pb5 pb6-ns pt1 pt5-ns"><div class=flex-l><div class="order-2 w-100 w-20-l ph5-m ph0-l mb4 sticky"><aside class="fixed-lTK mw5-l right-0 f6 bl-l b--moon-gray pv4 pv0-ns ph4-l nested-list-reset nested-links nested-copy-line-height"><p class=b>What's on this Page</p><nav id=TableOfContents><ul><li><a href=#get-package>Get Package</a></li><li><a href=#dps-client-api>DPS Client API</a><ul><li><a href=#initialize-dps>Initialize DPS</a></li><li><a href=#load-certificates-and-keys>Load certificates and keys</a></li><li><a href=#set-status-callbacks>Set status callbacks</a></li><li><a href=#provisioning>Provisioning</a></li></ul></li><li><a href=#example-application---dps_cloud_server>Example application - dps_cloud_server</a><ul><li><a href=#bootstrapping-device-with-mfg-certificates>Bootstrapping device with mfg certificates</a></li><li><a href=#device-initialization>Device initialization</a></li><li><a href=#running-dps_cloud_server>Running dps_cloud_server</a></li></ul></li></ul></nav><div date-pref><a href=https://plgd.dev/device-provisioning-service/overview/ class="dib f6 pl1 hover-bg-light-gray br-100" title="Overview "><svg class="fill-current" height="30" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg"><path d="M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"/><path d="M0 0h24v24H0z" fill="none"/></svg></a></div></aside></div><div class="order-1 w-60-l mw7 ph0 ph5-ns mid-gray nested-copy-line-height no-underline nested-links nested-img nested-copy-seperator nested-blockquote mt0-ns" style=flex-grow:1><div class="documentation-copy center measure-wide-l"><div id=readout class="fixed right-0 bottom-0"></div><header class="flex-none w-100"><a href=/categories/zero-touch class="f6 fw8 mb0 link mid-gray dim mr3">ZERO TOUCH</a>
<a href=/categories/provisioning class="f6 fw8 mb0 link mid-gray dim mr3">PROVISIONING</a><h1 class="lh-title mb3 mv0 pt3 primary-color-dark">Client Library</h1></header><aside class="bt bw1 pt3 mt2 mid-gray b--mid-gray fn w-100"><div class="f4 fw4 lh-copy">How to create a client of plgd Device Provisioning Service?</div></aside><div class=prose id=prose><h2 id=get-package>Get Package <a class=header-link href=#get-package><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The Device Provisioning Service is distributed as a <code>tar.gz</code> package, which contains the dps shared library, public C headers and an example application.</p><p>Latest version: 0.0.1</p><aside class="admonition note"><div class=note-icon></div><div class=admonition-content><p>Please examine the contents of the provided pkg-config (<code>.pc</code>) file and install required dependencies.</p></div></aside><h2 id=dps-client-api>DPS Client API <a class=header-link href=#dps-client-api><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The API is defined in the public header files provided in the distributed package.</p><p><code>dps.h</code>:</p><div class=highlight><pre class=chroma><code class=language-C data-lang=C><span class=p>...</span>

<span class=cm>/**
</span><span class=cm> * @brief Allocate and initialize data.
</span><span class=cm> *
</span><span class=cm> * @param skip_ca_verification if true then don&#39;t load and verify DPS CA certificate.
</span><span class=cm> * @return int  0   on success
</span><span class=cm> *              &lt;0  on failure
</span><span class=cm> */</span>
<span class=kt>int</span> <span class=n>plgd_dps_init</span><span class=p>(</span><span class=kt>bool</span> <span class=n>skip_ca_verification</span><span class=p>);</span>

<span class=cm>/**
</span><span class=cm> * @brief Stop all devices and deallocate data.
</span><span class=cm> */</span>
<span class=kt>void</span> <span class=nf>plgd_dps_shutdown</span><span class=p>(</span><span class=kt>void</span><span class=p>);</span>

<span class=c1>/// Get context for given device
</span><span class=c1></span><span class=n>plgd_dps_context_t</span> <span class=o>*</span><span class=nf>plgd_dps_get_context</span><span class=p>(</span><span class=n>size_t</span> <span class=n>device</span><span class=p>);</span>

<span class=c1>/// @brief Set DPS manager callbacks.
</span><span class=c1></span><span class=kt>void</span> <span class=nf>plgd_dps_manager_init_callbacks</span><span class=p>(</span><span class=n>plgd_dps_context_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=n>plgd_dps_on_status_change_cb_t</span> <span class=n>on_change_cb</span><span class=p>,</span>
                                     <span class=kt>void</span> <span class=o>*</span><span class=n>on_change_data</span><span class=p>,</span> <span class=n>oc_cloud_cb_t</span> <span class=n>on_cloud_change_cb</span><span class=p>,</span>
                                     <span class=kt>void</span> <span class=o>*</span><span class=n>on_cloud_change_data</span><span class=p>);</span>

<span class=cm>/**
</span><span class=cm> * @brief Start DPS manager to provision device by given server.
</span><span class=cm> *
</span><span class=cm> * Setup context, handlers, dps server and start dps manager.
</span><span class=cm> *
</span><span class=cm> * @param ctx device context (cannot be NULL)
</span><span class=cm> * @param endpoint endpoint of the provisioning server (cannot be NULL)
</span><span class=cm> * @return 0 on success
</span><span class=cm> * @return -1 on failure
</span><span class=cm> */</span>
<span class=kt>int</span> <span class=nf>plgd_dps_manager_start</span><span class=p>(</span><span class=n>plgd_dps_context_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>endpoint</span><span class=p>);</span>

<span class=cm>/**
</span><span class=cm> * @brief Stop DPS manager.
</span><span class=cm> *
</span><span class=cm> * Deregister handlers, clear context, stop manager and close connection.
</span><span class=cm> *
</span><span class=cm> * @param ctx device context (cannot be NULL)
</span><span class=cm> */</span>
<span class=kt>void</span> <span class=nf>plgd_dps_manager_stop</span><span class=p>(</span><span class=n>plgd_dps_context_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>);</span>

<span class=p>...</span>
</code></pre></div><p><code>dps_log.h</code>:</p><div class=highlight><pre class=chroma><code class=language-C data-lang=C><span class=p>...</span>

<span class=c1>/// @brief Set global logging function
</span><span class=c1></span><span class=kt>void</span> <span class=n>plgd_dps_set_log_fn</span><span class=p>(</span><span class=n>plgd_dps_print_log_fn_t</span> <span class=n>fn</span><span class=p>);</span>

<span class=c1>/// @brief Get global logging function
</span><span class=c1></span><span class=n>plgd_dps_print_log_fn_t</span> <span class=nf>plgd_dps_get_log_fn</span><span class=p>(</span><span class=kt>void</span><span class=p>);</span>

<span class=p>...</span>
</code></pre></div><h3 id=initialize-dps>Initialize DPS <a class=header-link href=#initialize-dps><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>A DPS client device is an extension of an <a href=https://github.com/iotivity/iotivity-lite>Iotivity-lite</a> device. Define your desired Iotivity-lite device and add DPS code to automatically provision the device.</p><p>Start up the DPS initialization by calling the <code>plgd_dps_init(bool skip_ca_verification)</code> function, which allocates and initializes required data structures.
Set the <code>skip_ca_verification</code> parameter to true to <a href=#load-certificates-and-keys>skip verification of the DPS endpoint</a>, otherwise set it to false.</p><h3 id=load-certificates-and-keys>Load certificates and keys <a class=header-link href=#load-certificates-and-keys><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>To be secure the device communicates with the DPS endpoint using TLS. Use <a href=https://github.com/iotivity/iotivity-lite/blob/master/include/oc_pki.h>PKI functions from Iotivity-lite</a> to add certificates to device.</p><p>Use <code>oc_pki_add_mfg_cert</code> function to add manufacturer&rsquo;s certificate and private key to device. This certificate will be used to sign communication with the DPS server, which then can authenticate and identify the device. On success, use the returned credential id to assign a security profile by calling <code>oc_pki_set_security_profile</code>. Additionally, assign the credential id value to <code>dps_mfg_credid</code> member variable on device context struct.</p><p>Use <code>oc_pki_add_trust_anchor</code> function to add trusted root certificate of the DPS server, this will be used to verify the DPS server. On success, assign the returned credential id value to <code>dps_ca_credid</code> member variable on device context struct.</p><aside class="admonition note"><div class=note-icon></div><div class=admonition-content><p>The verification of the DPS server can be disabled by setting the <code>skip_ca_verification</code> argument to false when calling <code>plgd_dps_init</code>.</p></div></aside><h3 id=set-status-callbacks>Set status callbacks <a class=header-link href=#set-status-callbacks><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>The DPS client device can optionally provide two custom callbacks to track the provisioning status and the cloud registration status by calling <code>plgd_dps_manager_init_callbacks</code> function. The status of cloud registration is part of the public API of <a href=https://github.com/iotivity/iotivity-lite/blob/master/include/oc_cloud.h>Iotivity-lite</a> and can be examined there.</p><p>The DPS status callback is executed whenever a provisioning step succeeds or fails. The callback has the following signature:</p><div class=highlight><pre class=chroma><code class=language-C data-lang=C><span class=kt>void</span> <span class=p>(</span><span class=o>*</span><span class=p>)(</span><span class=k>struct</span> <span class=n>plgd_dps_context_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=n>plgd_dps_status_t</span> <span class=n>status</span><span class=p>,</span> <span class=kt>void</span> <span class=o>*</span><span class=n>data</span><span class=p>);</span>
</code></pre></div><p>The <code>ctx</code> argument is device context created by <code>plgd_dps_init</code>, the <code>data</code> argument is a value provided to the call of <code>plgd_dps_manager_init_callbacks</code>. The <code>status</code> argument is an integer value, that consists of the following flags defined in the <code>dps.h</code> header:</p><div class=highlight><pre class=chroma><code class=language-C data-lang=C><span class=k>typedef</span> <span class=k>enum</span> <span class=p>{</span>
  <span class=n>PLGD_DPS_INITIALIZED</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>0</span><span class=p>,</span>
  <span class=n>PLGD_DPS_HAS_CREDENTIALS</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>1</span><span class=p>,</span>
  <span class=n>PLGD_DPS_HAS_ACLS</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>2</span><span class=p>,</span>
  <span class=n>PLGD_DPS_HAS_CLOUD</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>3</span><span class=p>,</span>
  <span class=n>PLGD_DPS_FAILURE</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>&lt;&lt;</span> <span class=mi>6</span><span class=p>,</span>
<span class=p>}</span> <span class=n>plgd_dps_status_t</span><span class=p>;</span>
</code></pre></div><h4 id=simple-logging-callback-to-tract-provisioning-state>Simple logging callback to tract provisioning state <a class=header-link href=#simple-logging-callback-to-tract-provisioning-state><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h4><div class=highlight><pre class=chroma><code class=language-C data-lang=C><span class=k>static</span> <span class=kt>void</span>
<span class=nf>dps_status_handler</span><span class=p>(</span><span class=n>plgd_dps_context_t</span> <span class=o>*</span><span class=n>ctx</span><span class=p>,</span> <span class=n>plgd_dps_status_t</span> <span class=n>status</span><span class=p>,</span> <span class=kt>void</span> <span class=o>*</span><span class=n>data</span><span class=p>)</span>
<span class=p>{</span>
  <span class=p>(</span><span class=kt>void</span><span class=p>)</span><span class=n>data</span><span class=p>;</span>
  <span class=p>(</span><span class=kt>void</span><span class=p>)</span><span class=n>ctx</span><span class=p>;</span>
  <span class=n>printf</span><span class=p>(</span><span class=s>&#34;</span><span class=se>\n</span><span class=s>DPS Manager Status:</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>status</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;</span><span class=se>\t\t</span><span class=s>-Uninitialized</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
  <span class=p>}</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>status</span> <span class=o>&amp;</span> <span class=n>PLGD_DPS_INITIALIZED</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;</span><span class=se>\t\t</span><span class=s>-Initialized</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
  <span class=p>}</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>status</span> <span class=o>&amp;</span> <span class=n>PLGD_DPS_HAS_CREDENTIALS</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;</span><span class=se>\t\t</span><span class=s>-Has credentials</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
  <span class=p>}</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>status</span> <span class=o>&amp;</span> <span class=n>PLGD_DPS_HAS_ACLS</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;</span><span class=se>\t\t</span><span class=s>-Has set acls</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
  <span class=p>}</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>status</span> <span class=o>&amp;</span> <span class=n>PLGD_DPS_HAS_CLOUD</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;</span><span class=se>\t\t</span><span class=s>-Has configured cloud</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
  <span class=p>}</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>status</span> <span class=o>&amp;</span> <span class=n>PLGD_DPS_FAILURE</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;</span><span class=se>\t\t</span><span class=s>-Failure</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
  <span class=p>}</span>
<span class=p>}</span>
</code></pre></div><h3 id=provisioning>Provisioning <a class=header-link href=#provisioning><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Provisioning algorithm is asynchronous and consists of several steps. Each step after it finishes schedules the next step. The whole process is fired up by calling <code>plgd_dps_manager_start</code>.</p><p>After the provisioning is successfully finished, the connection to DPS endpoint is closed and the registration to plgd cloud is started using the data that was set up during the provisioning.</p><h4 id=handling-failure>Handling failure <a class=header-link href=#handling-failure><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h4><p>If a step in the provisioning algorithm encounters an error, or if it does not trigger the next step (for example, the answer from DPS endpoint didn’t come, thus the handler didn’t trigger and schedule the next step), then the step is retried after a small interval.</p><p>The application uses the following retry intervals [10s, 20s, 40s, 80s, 120s] and forever loops through the array (i.e. when the last retry interval was 120s then the next will be 10s again) until the provisioning process succeeds.</p><h2 id=example-application---dps_cloud_server>Example application - dps_cloud_server <a class=header-link href=#example-application---dps_cloud_server><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Part of the package is an example application called <code>dps_cloud_server</code>. The following sections describe how DPS client library is integrated in the binary (with code examples). And the finally section shows how to run it.</p><h3 id=bootstrapping-device-with-mfg-certificates>Bootstrapping device with mfg certificates <a class=header-link href=#bootstrapping-device-with-mfg-certificates><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Currently, the handling of certificates is hard-coded into the binary. On start-up the process expects the certificates to be in a folder named <code>pki_certs</code> located next to the binary file. The folder must contain 3 files:</p><ul><li>dpsca.pem - certificate authority of the DPS</li><li>mfgcrt.pem - manufacture certificate of the device</li><li>mfgkey.pem - private key for the manufacture certificate</li></ul><p>The <code>dps_cloud_server</code> supports <code>--no-verify-ca</code> option. If you run the binary with this option, then the DPS endpoint will be used without authentication and you don&rsquo;t need the <code>dpsca.pem</code> file.</p><p>In code, the application uses <a href=#load-certificates-and-keys>Iotivity-lite&rsquo;s pki functions to load the certificates</a> in this helper function:</p><div class=highlight><pre class=chroma><code class=language-C data-lang=C><span class=k>static</span> <span class=kt>int</span>
<span class=nf>dps_add_certificates</span><span class=p>(</span><span class=n>plgd_dps_context_t</span> <span class=o>*</span><span class=n>dps_ctx</span><span class=p>)</span>
<span class=p>{</span>
  <span class=n>oc_assert</span><span class=p>(</span><span class=n>dps_ctx</span> <span class=o>!=</span> <span class=nb>NULL</span><span class=p>);</span>
<span class=cp>#define CERT_BUFFER_SIZE 4096
</span><span class=cp></span>
  <span class=k>if</span> <span class=p>(</span><span class=n>dps_ctx</span><span class=o>-&gt;</span><span class=n>dps_skip_ca_verification</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>DPS_DBG</span><span class=p>(</span><span class=s>&#34;adding of trusted root certificate skipped&#34;</span><span class=p>);</span>
  <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
    <span class=kt>unsigned</span> <span class=kt>char</span> <span class=n>dps_ca</span><span class=p>[</span><span class=n>CERT_BUFFER_SIZE</span><span class=p>];</span>
    <span class=n>size_t</span> <span class=n>dps_ca_len</span> <span class=o>=</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>dps_ca</span><span class=p>);</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>dps_read_pem</span><span class=p>(</span><span class=s>&#34;pki_certs/dpsca.pem&#34;</span><span class=p>,</span> <span class=p>(</span><span class=kt>char</span> <span class=o>*</span><span class=p>)</span><span class=n>dps_ca</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>dps_ca_len</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
      <span class=n>DPS_ERR</span><span class=p>(</span><span class=s>&#34;ERROR: unable to read pki_certs/dpsca.pem&#34;</span><span class=p>);</span>
      <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=kt>int</span> <span class=n>dpsca_credit</span> <span class=o>=</span> <span class=n>oc_pki_add_trust_anchor</span><span class=p>(</span><span class=n>dps_ctx</span><span class=o>-&gt;</span><span class=n>device</span><span class=p>,</span> <span class=n>dps_ca</span><span class=p>,</span> <span class=n>dps_ca_len</span><span class=p>);</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>dpsca_credit</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
      <span class=n>DPS_ERR</span><span class=p>(</span><span class=s>&#34;ERROR: installing DPS trusted root ca&#34;</span><span class=p>);</span>
      <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=n>DPS_DBG</span><span class=p>(</span><span class=s>&#34;DPS trusted root credid=%d&#34;</span><span class=p>,</span> <span class=n>dpsca_credit</span><span class=p>);</span>
    <span class=n>dps_ctx</span><span class=o>-&gt;</span><span class=n>dps_ca_credid</span> <span class=o>=</span> <span class=n>dpsca_credit</span><span class=p>;</span>
  <span class=p>}</span>

  <span class=kt>unsigned</span> <span class=kt>char</span> <span class=n>mfg_crt</span><span class=p>[</span><span class=n>CERT_BUFFER_SIZE</span><span class=p>];</span>
  <span class=n>size_t</span> <span class=n>mfg_crt_len</span> <span class=o>=</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>mfg_crt</span><span class=p>);</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>dps_read_pem</span><span class=p>(</span><span class=s>&#34;pki_certs/mfgcrt.pem&#34;</span><span class=p>,</span> <span class=p>(</span><span class=kt>char</span> <span class=o>*</span><span class=p>)</span><span class=n>mfg_crt</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>mfg_crt_len</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>DPS_ERR</span><span class=p>(</span><span class=s>&#34;ERROR: unable to read pki_certs/mfgcrt.pem&#34;</span><span class=p>);</span>
    <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
  <span class=p>}</span>
  <span class=kt>unsigned</span> <span class=kt>char</span> <span class=n>mfg_key</span><span class=p>[</span><span class=n>CERT_BUFFER_SIZE</span><span class=p>];</span>
  <span class=n>size_t</span> <span class=n>mfg_key_len</span> <span class=o>=</span> <span class=k>sizeof</span><span class=p>(</span><span class=n>mfg_key</span><span class=p>);</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>dps_read_pem</span><span class=p>(</span><span class=s>&#34;pki_certs/mfgkey.pem&#34;</span><span class=p>,</span> <span class=p>(</span><span class=kt>char</span> <span class=o>*</span><span class=p>)</span><span class=n>mfg_key</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>mfg_key_len</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>DPS_ERR</span><span class=p>(</span><span class=s>&#34;ERROR: unable to read pki_certs/mfgkey.pem</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
    <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
  <span class=p>}</span>
  <span class=kt>int</span> <span class=n>mfg_credid</span> <span class=o>=</span> <span class=n>oc_pki_add_mfg_cert</span><span class=p>(</span><span class=n>dps_ctx</span><span class=o>-&gt;</span><span class=n>device</span><span class=p>,</span> <span class=n>mfg_crt</span><span class=p>,</span> <span class=n>mfg_crt_len</span><span class=p>,</span> <span class=n>mfg_key</span><span class=p>,</span> <span class=n>mfg_key_len</span><span class=p>);</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>mfg_credid</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>DPS_ERR</span><span class=p>(</span><span class=s>&#34;ERROR: installing manufacturer certificate</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
    <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
  <span class=p>}</span>
  <span class=n>DPS_DBG</span><span class=p>(</span><span class=s>&#34;manufacturer certificate credid=%d&#34;</span><span class=p>,</span> <span class=n>mfg_credid</span><span class=p>);</span>
  <span class=n>dps_ctx</span><span class=o>-&gt;</span><span class=n>dps_mfg_credid</span> <span class=o>=</span> <span class=n>mfg_credid</span><span class=p>;</span>
  <span class=n>oc_pki_set_security_profile</span><span class=p>(</span><span class=n>dps_ctx</span><span class=o>-&gt;</span><span class=n>device</span><span class=p>,</span> <span class=n>OC_SP_BLACK</span><span class=p>,</span> <span class=n>OC_SP_BLACK</span><span class=p>,</span> <span class=n>mfg_credid</span><span class=p>);</span>
  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div><h3 id=device-initialization>Device initialization <a class=header-link href=#device-initialization><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Now we have all the parts necessary to do the full initialization of the DPS client device:</p><div class=highlight><pre class=chroma><code class=language-C data-lang=C>  <span class=p>...</span>
  <span class=n>oc_main_init</span><span class=p>(...);</span>
  <span class=p>...</span>

  <span class=n>plgd_dps_init</span><span class=p>(</span><span class=n>skip_ca_verification</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>);</span>
  <span class=n>plgd_dps_context_t</span> <span class=o>*</span><span class=n>dps_ctx</span> <span class=o>=</span> <span class=n>plgd_dps_get_context</span><span class=p>(</span><span class=n>device_id</span><span class=p>);</span>
  <span class=k>if</span> <span class=p>(</span><span class=n>dps_ctx</span> <span class=o>!=</span> <span class=nb>NULL</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>dps_add_certificates</span><span class=p>(</span><span class=n>dps_ctx</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
      <span class=n>DPS_ERR</span><span class=p>(</span><span class=s>&#34;failed to add initial certificates&#34;</span><span class=p>);</span>
      <span class=k>goto</span> <span class=n>finish</span><span class=p>;</span>
    <span class=p>}</span>
    <span class=n>plgd_dps_manager_init_callbacks</span><span class=p>(</span><span class=n>dps_ctx</span><span class=p>,</span> <span class=n>dps_status_handler</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>,</span> <span class=n>cloud_status_handler</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>);</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>plgd_dps_manager_start</span><span class=p>(</span><span class=n>dps_ctx</span><span class=p>,</span> <span class=n>dps_endpoint</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
      <span class=n>DPS_ERR</span><span class=p>(</span><span class=s>&#34;failed to start dps manager&#34;</span><span class=p>);</span>
      <span class=k>goto</span> <span class=n>finish</span><span class=p>;</span>
    <span class=p>}</span>
  <span class=p>}</span>

  <span class=p>...</span>
  <span class=n>run</span><span class=p>();</span> <span class=c1>// start run loop
</span><span class=c1></span>  <span class=p>...</span>
</code></pre></div><h3 id=running-dps_cloud_server>Running dps_cloud_server <a class=header-link href=#running-dps_cloud_server><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Use <code>--help</code> switch to get information about how to correctly start up the process.</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ ./dps_cloud_server --help

./dps_cloud_server <span class=o>[</span>device-name<span class=o>]</span> <span class=o>[</span>endpoint<span class=o>]</span>

OPTIONS:
  -h <span class=p>|</span> --help                print <span class=nb>help</span>
  --no-verify-ca             skip loading of the DPS certificate authority

ARGUMENTS:
  device-name                name of the device <span class=o>(</span>optional, default: dps<span class=o>)</span>
  endpoint                   address of the endpoint <span class=o>(</span>optional, default: coaps+tcp://127.0.0.1:20030<span class=o>)</span>
</code></pre></div><p>The binary takes two optional positional arguments <code>device-name</code> and <code>endpoint</code>. If they are not specified, default values are used instead. The <code>device-name</code> argument will be used as the name of the device after it is registered to the plgd cloud. The <code>endpoint</code> argument is the endpoint of a running DPS service.</p><p>For example, if your DPS endpoint is running on the address <code>api.try.plgd.cloud:25684</code> then start your device named <code>my-device</code> by the following call:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>./dps_cloud_server <span class=s2>&#34;my-device&#34;</span> <span class=s2>&#34;coaps+tcp://api.try.plgd.cloud:25684&#34;</span>
</code></pre></div></div><h2>See Also</h2><ul><li><a href=/features/provisioning/>Device Provisioning</a></li><li><a href=/device-provisioning-service/overview/>Overview</a></li></ul></div></div><div class="order-0 w-20 dn db-l"><nav role=navigation><ul class="list pa0 nl2"><li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8"><a href=javascript:void(0) class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2" data-target=.introduction>Introduction</a><ul class="introduction desktopmenu animated fadeIn list pl0 bg-light-gray dn"><li class="f6 fw4"><a href=/introduction/what-is-plgd/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">What is plgd</a></li><li class="f6 fw4"><a href=/introduction/who-we-are/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Who we are</a></li><li class="f6 fw4"><a href=/introduction/compare-plgd/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Compare plgd</a></li><li class="f6 fw4"><a href=/introduction/faq/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">FAQ</a></li></ul></li><li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8 mb1 bb b--moon-gray"><a href=javascript:void(0) class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2" data-target=.quickstart>Quickstart</a><ul class="quickstart desktopmenu animated fadeIn list pl0 bg-light-gray dn"><li class="f6 fw4"><a href=/quickstart/contribute/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Contribute</a></li><li class="f6 fw4"><a href=/quickstart/create-device/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Create device</a></li><li class="f6 fw4"><a href=/quickstart/device-to-device/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Discover & control device locally</a></li><li class="f6 fw4"><a href=/quickstart/device-to-hub/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Control device remotely</a></li><li class="f6 fw4"><a href=/quickstart/deploy-plgd-hub/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Deploy your own plgd hub</a></li><li class="f6 fw4"><a href=/quickstart/create-plgd-app/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Create first plgd application</a></li></ul></li><li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8"><a href=javascript:void(0) class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2" data-target=.features>Features</a><ul class="features desktopmenu animated fadeIn list pl0 bg-light-gray dn"><li class="f6 fw4"><a href=/features/audit-log/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Audit Log</a></li><li class="f6 fw4"><a href=/features/pending-command/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Pending command</a></li><li class="f6 fw4"><a href=/features/provisioning/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Device Provisioning</a></li><li class="f6 fw4"><a href=/features/device-shadow/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Device Shadow</a></li><li class="f6 fw4"><a href=/features/disaster-recovery/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Disaster Recovery</a></li><li class="f6 fw4"><a href=/features/jetstream/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">JetStream</a></li></ul></li><li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8"><a href=javascript:void(0) class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2" data-target=.architecture>Architecture</a><ul class="architecture desktopmenu animated fadeIn list pl0 bg-light-gray dn"><li class="f6 fw4"><a href=/architecture/introduction/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Domain Overview</a></li><li class="f6 fw4"><a href=/architecture/component-overview/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Component Overview</a></li><li class="f6 fw4"><a href=/architecture/system-overview/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">System Overview</a></li></ul></li><li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8"><a href=javascript:void(0) class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2" data-target=.configuration>Configuration</a><ul class="configuration desktopmenu animated fadeIn list pl0 bg-light-gray dn"><li class="f6 fw4"><a href=/configuration/coap-gateway/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">CoAP Gateway</a></li><li class="f6 fw4"><a href=/configuration/grpc-gateway/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">gRPC Gateway</a></li><li class="f6 fw4"><a href=/configuration/http-gateway/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">HTTP Gateway</a></li><li class="f6 fw4"><a href=/configuration/resource-aggregate/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Resource Aggregate</a></li><li class="f6 fw4"><a href=/configuration/resource-directory/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Resource Directory</a></li><li class="f6 fw4"><a href=/configuration/identity-store/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Identity Store</a></li><li class="f6 fw4"><a href=/configuration/cloud2cloud-gateway/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Cloud2Cloud Gateway</a></li><li class="f6 fw4"><a href=/configuration/cloud2cloud-connector/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Cloud2Cloud Connector</a></li><li class="f6 fw4"><a href=/configuration/certificate-authority/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Certificate Authority</a></li><li class="f6 fw4"><a href=/configuration/oauth-server/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">[MOCK] OAuth Server</a></li></ul></li><li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8"><a href=javascript:void(0) class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2" data-target=.deployment>Deployment</a><ul class="deployment desktopmenu animated fadeIn list pl0 bg-light-gray dn"><li class="f6 fw4"><a href=/deployment/k8s/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">plgd on K8S</a></li></ul></li><li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8 mb1 bb b--moon-gray"><a href=/device-library/ class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2" data-target=.device-library>Device Library</a></li><li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8 mb1 bb b--moon-gray"><a href=javascript:void(0) class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2" data-target=.tutorials>Tutorials</a><ul class="tutorials desktopmenu animated fadeIn list pl0 bg-light-gray dn"><li class="f6 fw4"><a href=/tutorials/external-oauth-server/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">External OAuth Server with bundle</a></li><li class="f6 fw4"><a href=/tutorials/shared-ownership/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Share devices within user groups</a></li><li class="f6 fw4"><a href=/tutorials/dashboard-branding/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Branding dashboard</a></li><li class="f6 fw4"><a href=/tutorials/working-with-grpc-client/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Working with gRPC Client</a></li><li class="f6 fw4"><a href=/tutorials/create-delete-device-resources/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Create & Delete device resources</a></li><li class="f6 fw4"><a href=/tutorials/advanced-security/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Advanced security</a></li><li class="f6 fw4"><a href=/tutorials/developing-dashboard/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Dashboard</a></li><li class="f6 fw4"><a href=/tutorials/testing/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Testing</a></li><li class="f6 fw4"><a href=/tutorials/ocf-conformance-testing/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">OCF Conformance Testing</a></li></ul></li><li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8"><a href=javascript:void(0) class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2 primary-color" data-target=.device-provisioning-service>Device Provisioning Service</a><ul class="device-provisioning-service desktopmenu animated fadeIn list pl0 bg-light-gray db"><li class="f6 fw4"><a href=/device-provisioning-service/overview/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Overview</a></li><li class="f6 fw4"><a href=/device-provisioning-service/attestation-mechanisms/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">Attestation Mechanisms</a></li><li class="f6 fw4"><a href=/device-provisioning-service/client-library/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 primary-color">Client Library</a></li></ul></li></ul></nav></div></div></article><div class="w-100 bg-light-gray"><div class="mw7 pa4 center nested-lh-copy lh-copy"><h6 class="f4 dark-gray mb2"><a href=https://plgd.dev/device-provisioning-service/client-library/ class="hide-child link primary-color"><span class="nl3 child"><svg class="grow" height="14" viewBox="0 0 24 24" width="14" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></span>“Client Library”</a> was last updated: February 16, 2022: <a class="hide-child link primary-color" href=https://github.com/plgd-dev/hub/commit/330d475d1566067b1717676816c3aaf75a815774>DPS client library documentation (330d475)</a></h6><a href=https://github.com/plgd-dev/hub/edit/master/content/en/device-provisioning-service/client-library.md class="f6 ph3 pv1 br2 dib tc ttu mv3 bg-primary-color white hover-bg-green link">Improve this page</a></div></div></main><footer class="bg-primary-color-dark ph4-ns pt4 relative w-100" role=contentinfo><div class="center flex-ns flex-wrap justify-between mw9 w-90"><div class="pb3 pt1 center"><div class="center w4"><img src=/images/plgd-logo-short-white.svg alt="plgd Logo"></div><ul class="center f6 list ma0 mv3 pa0 tc"><li class="dib mr3"><a href=https://github.com/plgd-dev/hub/issues/new/ class="dim link light-gray pv2">File an Issue</a></li><li class="dib mr3"><a href=https://gitter.im/ocfcloud/Lobby class="dim link light-gray pv2">Discuss Source Code</a></li><li class=dib><a href=https://try.plgd.cloud class="dim link light-gray pv2">Try plgd hub</a></li></ul><div class="center f7 gray tc"> <p class=dib>© plgd.dev 2018–2022</p></div></div></div><div class="bg-primary-color-dark bottom-0 left-0 right-0 dn-l fixed pb3 ph3 pt3 w-100"><div class="globalmenu mobilemenu pb1 dn"><ul class="list hidden dib ph0 scrolling-touch tc"><li class="tl dib ma0 hover-bg-black w-100"><a href=/documentation/ class="ttu f6 link primary-color-light overflow hover-white db brand-font ma0 w-100 pv3 ph4">Docs</a></li><li class="tl dib ma0 hover-bg-black w-100"><a href=/news/ class="ttu f6 link primary-color-light overflow hover-white db brand-font ma0 w-100 pv3 ph4">News</a></li><li class="tl dib ma0 hover-bg-black w-100"><a href=https://gitter.im/ocfcloud/Lobby/ class="ttu f6 link primary-color-light overflow hover-white db brand-font ma0 w-100 pv3 ph4">Community</a></li><li class="tl dib ma0 hover-bg-black w-100"><a href=https://try.plgd.cloud class="ttu f6 link primary-color-light overflow hover-white db brand-font ma0 w-100 pv3 ph4">Try LIVE</a></li></ul></div><div class="docsmenu mobilemenu pb1 dn"><ul class="list dib ph0 scrolling-touch tc"><li class="tl dib ma0 hover-bg-black w-100"><a href=/introduction/ class="ttu f6 link primary-color-light hover-white db brand-font mb1 ma0 w-100 pv2 ph4">Introduction</a></li><li class="tl dib ma0 hover-bg-black w-100 mb2 bb b--mid-gray"><a href=/quickstart/ class="ttu f6 link primary-color-light hover-white db brand-font mb1 ma0 w-100 pv2 ph4">Quickstart</a></li><li class="tl dib ma0 hover-bg-black w-100"><a href=/features/ class="ttu f6 link primary-color-light hover-white db brand-font mb1 ma0 w-100 pv2 ph4">Features</a></li><li class="tl dib ma0 hover-bg-black w-100"><a href=/architecture/ class="ttu f6 link primary-color-light hover-white db brand-font mb1 ma0 w-100 pv2 ph4">Architecture</a></li><li class="tl dib ma0 hover-bg-black w-100"><a href=/configuration/ class="ttu f6 link primary-color-light hover-white db brand-font mb1 ma0 w-100 pv2 ph4">Configuration</a></li><li class="tl dib ma0 hover-bg-black w-100"><a href=/deployment/ class="ttu f6 link primary-color-light hover-white db brand-font mb1 ma0 w-100 pv2 ph4">Deployment</a></li><li class="tl dib ma0 hover-bg-black w-100 mb2 bb b--mid-gray"><a href=/device-library/ class="ttu f6 link primary-color-light hover-white db brand-font mb1 ma0 w-100 pv2 ph4">Device Library</a></li><li class="tl dib ma0 hover-bg-black w-100 mb2 bb b--mid-gray"><a href=/tutorials/ class="ttu f6 link primary-color-light hover-white db brand-font mb1 ma0 w-100 pv2 ph4">Tutorials</a></li><li class="tl dib ma0 hover-bg-black w-100"><a href=/device-provisioning-service/ class="ttu f6 link primary-color-light hover-white db brand-font mb1 ma0 w-100 pv2 ph4">Device Provisioning Service</a></li></ul></div><div class="flex dn-l justify-between"><button class="js-toggle flex-auto dib dn-l f6 tc db ph3 pv2 link mr2 white bg-primary-color-dark hover-bg-primary-color ba b--white-40 w-auto" data-target=.globalmenu>Menu</button>
<button class="js-toggle flex-auto dib dn-l f6 tc db ph3 pv2 link white bg-primary-color-dark hover-bg-primary-color ba b--white-40 w-auto" data-target=.docsmenu>Docs Menu</button></div></div></footer></body></html>